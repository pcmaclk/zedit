# 开发计划更新

## 当前状态：MVP 完成 + 国际化设计

### ✅ 已完成

1. **MVP 核心功能**
   - ✅ 基础UI框架（菜单、工具栏、标签页、编辑区、状态栏）
   - ✅ 中文字体支持（系统字体检测）
   - ✅ 文档显示功能（基于Ropey）
   - ✅ 模块化架构设计

2. **国际化设计**
   - ✅ 国际化模块详细设计文档
   - ✅ 架构设计完成

## 📋 更新后的开发计划

### 阶段一：核心编辑功能 (优先级最高)

#### 1. 文件打开功能

- **目标**: 实现文件选择对话框和文件加载
- **依赖**: 现有UI框架
- **预计时间**: 1-2小时
- **关键任务**:
  - 集成 `rfd` crate（文件对话框）
  - 实现文件选择逻辑
  - 加载文件到Document
  - 错误处理（文件不存在、编码错误等）

#### 2. 基础光标移动

- **目标**: 支持键盘导航（方向键、Home/End、PageUp/Down）
- **依赖**: 文件打开功能
- **预计时间**: 1-2小时
- **关键任务**:
  - 在Editor中添加光标状态（行、列）
  - 处理键盘输入事件
  - 光标边界检查
  - 视图滚动跟随

#### 3. 文本编辑功能

- **目标**: 支持插入、删除、换行
- **依赖**: 光标系统
- **预计时间**: 2-3小时
- **关键任务**:
  - 实现插入操作
  - 实现删除操作（Backspace、Delete）
  - 实现换行操作
  - 处理特殊字符（Tab、Enter）

#### 4. Undo/Redo 功能
- **目标**: 基于Ropey的版本历史管理
- **依赖**: 文本编辑功能
- **预计时间**: 2-3小时
- **关键任务**:
  - 设计命令模式
  - 实现历史栈
  - 撤销/重做操作
  - 内存优化（限制历史深度）

### 阶段二：性能优化

#### 5. 虚拟渲染优化
- **目标**: 大文件性能提升（支持1GB+文件）
- **依赖**: 现有渲染系统
- **预计时间**: 3-4小时
- **关键任务**:
  - 可见行检测
  - 只渲染可见区域
  - 滚动优化
  - 性能测试

### 阶段三：高级功能

#### 6. 语法高亮 (Syntect)
- **目标**: TextMate/Sublime风格的语法高亮
- **依赖**: 虚拟渲染
- **预计时间**: 4-5小时
- **关键任务**:
  - 集成Syntect库
  - 增量高亮算法
  - 主题支持
  - 性能优化

#### 7. 多标签页支持
- **目标**: 同时打开多个文档
- **依赖**: 现有架构
- **预计时间**: 2-3小时
- **关键任务**:
  - 标签页管理
  - 文档切换
  - 状态保存
  - 内存管理

#### 8. 搜索/替换功能
- **目标**: 支持文本搜索和替换
- **依赖**: 文本编辑功能
- **预计时间**: 2-3小时
- **关键任务**:
  - 搜索界面
  - 正则表达式支持
  - 高亮匹配项
  - 替换操作

### 阶段四：国际化实现

#### 9. 国际化(i18n)实现
- **目标**: 实现多语言支持（中英文）
- **依赖**: 所有UI功能完成
- **预计时间**: 2-3小时
- **关键任务**:
  - 创建i18n模块（基于设计文档）
  - 替换所有硬编码字符串
  - 添加语言切换功能
  - 测试中英文切换

### 阶段五：主题系统

#### 10. 主题切换系统
- **目标**: 支持亮/暗主题
- **依赖**: UI框架
- **预计时间**: 2-3小时
- **关键任务**:
  - 主题定义
  - 颜色管理
  - 运行时切换
  - 持久化存储

### 阶段六：工程化

#### 11. 配置系统
- **目标**: 用户偏好设置持久化
- **依赖**: 主题系统
- **预计时间**: 1-2小时
- **关键任务**:
  - 配置文件管理
  - 持久化存储
  - 配置界面

#### 12. 性能优化和测试
- **目标**: 大文件测试、性能调优
- **依赖**: 所有功能完成
- **预计时间**: 3-4小时
- **关键任务**:
  - 大文件测试（10MB, 100MB, 1GB）
  - 内存使用优化
  - CPU性能分析
  - 边界情况测试

#### 13. 打包发布准备
- **目标**: 跨平台发布
- **依赖**: 所有功能完成
- **预计时间**: 2-3小时
- **关键任务**:
  - Release构建
  - 跨平台测试（Windows, macOS, Linux）
  - 安装包制作
  - 文档完善

## 🎯 优先级调整

### 高优先级 (立即开始)
1. ✅ **MVP完成** - 已完成
2. 🔄 **文件打开功能** - 待开发
3. 🔄 **基础光标移动** - 待开发
4. 🔄 **文本编辑功能** - 待开发

### 中优先级 (核心功能完成后)
5. 📋 **Undo/Redo功能**
6. 📋 **虚拟渲染优化**
7. 📋 **语法高亮**

### 低优先级 (功能完善阶段)
8. 📋 **多标签页**
9. 📋 **搜索/替换**
10. 📋 **国际化实现**
11. 📋 **主题系统**
12. 📋 **配置系统**
13. 📋 **性能优化和测试**
14. 📋 **打包发布准备**

## 📝 重要说明

### 关于国际化开发时机
虽然已经完成了国际化设计文档，但**实际代码实现建议在核心编辑功能完成后进行**，原因：

1. **避免重复工作**: UI可能在开发过程中调整
2. **专注核心**: 先确保编辑器能正常使用
3. **翻译准确性**: UI稳定后翻译更准确

### 模块依赖关系
```
main.rs
  ↓
app.rs (应用状态)
  ↓
editor.rs (编辑器协调)
  ↓
document.rs (文档管理)
  ↓
buffer.rs (Ropey封装)
  ↓
io/file.rs (文件操作)
```

### 关键技术点
- **Ropey**: 大文件文本操作
- **egui**: UI框架
- **rfd**: 文件对话框
- **Syntect**: 语法高亮
- **i18n**: 多语言支持

## 🚀 下一步行动

**立即开始**: 文件打开功能
1. 添加 `rfd` 依赖到 Cargo.toml
2. 在 `io/file.rs` 中实现文件选择函数
3. 在 `main_window.rs` 中连接"打开"按钮
4. 测试文件加载和显示

预计完成时间: 2025-12-30 16:00

---

**文档版本**: v1.1  
**更新日期**: 2025-12-30  
**更新内容**: 添加国际化设计，调整开发计划优先级